<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Solutions to Time Series Analysis: with Applications in R</title>
  <meta name="description" content="This book contains solutions to the problems in the book Time Series Analysis with Applications in R, second edition, by Cryer and Chan. It is provided as a github repository so that anybody may contribute to its development.">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Solutions to Time Series Analysis: with Applications in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/tsa.png" />
  <meta property="og:description" content="This book contains solutions to the problems in the book Time Series Analysis with Applications in R, second edition, by Cryer and Chan. It is provided as a github repository so that anybody may contribute to its development." />
  <meta name="github-repo" content="jolars/TSAsolutions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Solutions to Time Series Analysis: with Applications in R" />
  
  <meta name="twitter:description" content="This book contains solutions to the problems in the book Time Series Analysis with Applications in R, second edition, by Cryer and Chan. It is provided as a github repository so that anybody may contribute to its development." />
  <meta name="twitter:image" content="images/tsa.png" />

<meta name="author" content="Johan Larsson">


<meta name="date" content="2017-04-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="fundamental-concepts.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#larain"><i class="fa fa-check"></i><b>1.1</b> Larain</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#colors"><i class="fa fa-check"></i><b>1.2</b> Colors</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#random-normal-time-series"><i class="fa fa-check"></i><b>1.3</b> Random, normal time series</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#random-chi2-distributed-time-series"><i class="fa fa-check"></i><b>1.4</b> Random, <span class="math inline">\(\chi^2\)</span>-distributed time series</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#t5-distributed-random-values"><i class="fa fa-check"></i><b>1.5</b> <em>t</em>(5)-distributed, random values</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#dubuque-temperature-series"><i class="fa fa-check"></i><b>1.6</b> Dubuque temperature series</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html"><i class="fa fa-check"></i><b>2</b> Fundamental concepts</a><ul>
<li class="chapter" data-level="2.1" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#basic-properties-of-expected-value-and-covariance"><i class="fa fa-check"></i><b>2.1</b> Basic properties of expected value and covariance</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#dependence-and-covariance"><i class="fa fa-check"></i><b>2.2</b> Dependence and covariance</a></li>
<li class="chapter" data-level="2.3" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#strict-and-weak-stationarity"><i class="fa fa-check"></i><b>2.3</b> Strict and weak stationarity</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-1"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-1"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-1"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-white-noise"><i class="fa fa-check"></i><b>2.4</b> Zero-mean white noise</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-2"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-2"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-stationary-series"><i class="fa fa-check"></i><b>2.5</b> Zero-mean stationary series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-3"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-3"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-2"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#stationary-time-series"><i class="fa fa-check"></i><b>2.6</b> Stationary time series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-4"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-4"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#first-and-second-order-difference-series"><i class="fa fa-check"></i><b>2.7</b> First and second-order difference series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-5"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-5"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#generalized-difference-series"><i class="fa fa-check"></i><b>2.8</b> Generalized difference series</a></li>
<li class="chapter" data-level="2.9" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-stationary-difference-series"><i class="fa fa-check"></i><b>2.9</b> Zero-mean stationary difference series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-6"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-6"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-unit-variance-process"><i class="fa fa-check"></i><b>2.10</b> Zero-mean, unit-variance process</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-7"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-7"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-3"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#drift"><i class="fa fa-check"></i><b>2.11</b> Drift</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-8"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-8"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#periods"><i class="fa fa-check"></i><b>2.12</b> Periods</a></li>
<li class="chapter" data-level="2.13" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#drift-part-2"><i class="fa fa-check"></i><b>2.13</b> Drift, part 2</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-9"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-9"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#stationarity-again"><i class="fa fa-check"></i><b>2.14</b> Stationarity, again</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-10"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-10"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-4"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-variable-zero-mean"><i class="fa fa-check"></i><b>2.15</b> Random variable, zero mean</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-11"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-11"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-5"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.16" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#mean-and-variance"><i class="fa fa-check"></i><b>2.16</b> Mean and variance</a></li>
<li class="chapter" data-level="2.17" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#variance-of-sample-mean"><i class="fa fa-check"></i><b>2.17</b> Variance of sample mean</a></li>
<li class="chapter" data-level="2.18" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#sample-variance"><i class="fa fa-check"></i><b>2.18</b> Sample variance</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-12"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-12"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-6"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.19" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-walk-with-drift"><i class="fa fa-check"></i><b>2.19</b> Random walk with drift</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-13"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-13"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-7"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.20" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-walk"><i class="fa fa-check"></i><b>2.20</b> Random walk</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-14"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-14"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-8"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.21" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-walk-with-random-starting-value"><i class="fa fa-check"></i><b>2.21</b> Random walk with random starting value</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-15"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-15"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-9"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#d"><i class="fa fa-check"></i>d</a></li>
</ul></li>
<li class="chapter" data-level="2.22" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#asymptotic-stationarity"><i class="fa fa-check"></i><b>2.22</b> Asymptotic stationarity</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-16"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-16"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-10"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#d-1"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#e"><i class="fa fa-check"></i>e</a></li>
</ul></li>
<li class="chapter" data-level="2.23" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#stationarity-in-sums-of-stochastic-processes"><i class="fa fa-check"></i><b>2.23</b> Stationarity in sums of stochastic processes</a></li>
<li class="chapter" data-level="2.24" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#measurement-noise"><i class="fa fa-check"></i><b>2.24</b> Measurement noise</a></li>
<li class="chapter" data-level="2.25" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-cosine-wave"><i class="fa fa-check"></i><b>2.25</b> Random cosine wave</a></li>
<li class="chapter" data-level="2.26" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#semivariogram"><i class="fa fa-check"></i><b>2.26</b> Semivariogram</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-17"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-17"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.27" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#polynomials"><i class="fa fa-check"></i><b>2.27</b> Polynomials</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-18"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-18"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.28" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-cosine-wave-extended"><i class="fa fa-check"></i><b>2.28</b> Random cosine wave extended</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-19"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-19"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.29" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-cosine-wave-further"><i class="fa fa-check"></i><b>2.29</b> Random cosine wave further</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-20"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-20"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.30" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#rayleigh-distribution"><i class="fa fa-check"></i><b>2.30</b> Rayleigh distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="trends.html"><a href="trends.html"><i class="fa fa-check"></i><b>3</b> Trends</a><ul>
<li class="chapter" data-level="3.1" data-path="trends.html"><a href="trends.html#least-squares-estimation-for-linear-regression-trend"><i class="fa fa-check"></i><b>3.1</b> Least squares estimation for linear regression trend</a></li>
<li class="chapter" data-level="3.2" data-path="trends.html"><a href="trends.html#variance-of-mean-estimator"><i class="fa fa-check"></i><b>3.2</b> Variance of mean estimator</a></li>
<li class="chapter" data-level="3.3" data-path="trends.html"><a href="trends.html#variance-of-mean-estimator-2"><i class="fa fa-check"></i><b>3.3</b> Variance of mean estimator #2</a></li>
<li class="chapter" data-level="3.4" data-path="trends.html"><a href="trends.html#hours"><i class="fa fa-check"></i><b>3.4</b> Hours</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-21"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-21"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="trends.html"><a href="trends.html#wages"><i class="fa fa-check"></i><b>3.5</b> Wages</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-22"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-22"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-11"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#d-2"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#e-1"><i class="fa fa-check"></i>e</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="trends.html"><a href="trends.html#beer-sales"><i class="fa fa-check"></i><b>3.6</b> Beer sales</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-23"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-23"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-12"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#d-3"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#e-2"><i class="fa fa-check"></i>e</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Solutions to Time Series Analysis: with Applications in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trends" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Trends</h1>
<div id="least-squares-estimation-for-linear-regression-trend" class="section level2">
<h2><span class="header-section-number">3.1</span> Least squares estimation for linear regression trend</h2>
<p>We begin by taking the partial derivatives with respect to <span class="math inline">\(\beta_0\)</span>.</p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_0}} \mathcal{Q}(\beta_0, \beta_1) =
  -2\sum_{t=1}^n (Y_t - \beta_0 - \beta_1 t)
\]</span></p>
<p>We set it to <span class="math inline">\(0\)</span> and from this retrieve</p>
\begin{align*}
-2\sum_{t=1}^n (Y_t - \beta_0 - \beta_1 t) = &amp; 0 \implies \\
\sum_{t=1}^n Y_t - n\beta_0 - \beta_1 \sum_{t=1}^n t = &amp; 0 \implies \\
\beta_0 = \frac{\sum_{t=1}^n Y_t - \beta_1 \sum_{t=1}^n t}{n} = &amp;
  \bar{Y} - \beta_1 \bar{t}
\end{align*}
<p>Next, we take the partial derivative with respect to <span class="math inline">\(\beta_1\)</span>;</p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_1}} \mathcal{Q}(\beta_0, \beta_1) =
  -2\sum_{t=1}^n t(Y_t - \beta_0 - \beta_1 t)
\]</span></p>
<p>Setting this to <span class="math inline">\(0\)</span> as well, multiplying both sides with <span class="math inline">\(-1/2\)</span> and rearranging results in</p>
\begin{align*}
-2\sum_{t=1}^n t (Y_t - \beta_0 - \beta_1 t) = &amp; 0 \implies \\
\beta_1 \sum_{t=1}^n t^2 = &amp; \sum_{t=1}^n Y_t t - \beta_0 \sum_{t=1}^n t
\end{align*}
<p>Then, substituting with the result gained previously for <span class="math inline">\(\beta_0\)</span>, we get</p>
\begin{align*}
\beta_1 \sum_{t=1}^n t^2 = &amp; \sum_{t=1}^n Y_t t - 
 \left( \frac{\sum_{t=1}^n Y_t}{n} - \beta_1 \frac{\sum_{t=1}^n}{n} \right)
 \sum_{t=1}^n t \iff \\
\beta_1 \left( \sum_{t=1}^n t^2 - \frac{(\sum_{t=1}^n t)^2}{n} \right) = &amp; 
  \sum_{t=1}^n Y_t t - \frac{\sum_{t=1}^n Y_t \sum_{t=1}^n t}{n} \iff \\
\beta_1 = &amp; \frac{n\sum_{t=1}^n Y_tt - \sum_{t=1}^nY_t \sum_{t=1}^n t}{n \sum_{t=1}^n t^2 - \left( \sum_{t=1}^n t \right)^2} = 
  \frac{\sum_{t=1}^n (Y_t - \bar{Y})(t-\bar{t})}{\sum_{t=1}^n (t-\bar{t})^2} \quad \square
\end{align*}
</div>
<div id="variance-of-mean-estimator" class="section level2">
<h2><span class="header-section-number">3.2</span> Variance of mean estimator</h2>
<p><span class="math display">\[
  \bar{Y} = \frac{1}{n}\sum_{t=1}^n Y_t = \frac{1}{n} \sum_{t=1}^n(\mu + e_t - e_{t-1}) = 
    \mu + \frac{1}{n} \sum_{t=1}^n (e_t - e_{t-1}) = \mu + \frac{1}{n}(e_n - e_0)
\]</span></p>
<p><span class="math display">\[
  \text{Var}[\bar{Y}] = \text{Var}[\mu + \frac{1}{n}(e_n - e_0)] =
    \frac{1}{n^2}(\sigma_e^2 + \sigma_e^2) = \frac{2\sigma_e^2}{n^2}
\]</span></p>
<p>It is uncommon for the sample size to have such a large impact on the variance estimator for the sample mean.</p>
<p>Setting <span class="math inline">\(Y_t = \mu + e_t\)</span> instead gives</p>
<p><span class="math display">\[
  \bar{Y} = \frac{1}{n}\sum_{t=1}^n Y_t = \frac{1}{n} \sum_{t=1}^n(\mu + e_t) = 
    \mu + \frac{1}{n} \sum_{t=1}^n e_t
\]</span></p>
<p><span class="math display">\[
  \text{Var}[\bar{Y}] = \text{Var} \left[ \mu + \frac{1}{n} \sum_{t=1}^n e_t \right] =
    0 + \frac{1}{n^2} \times n \sigma_e^2 = \frac{\sigma_e^2}{n}.
\]</span></p>
</div>
<div id="variance-of-mean-estimator-2" class="section level2">
<h2><span class="header-section-number">3.3</span> Variance of mean estimator #2</h2>
<p><span class="math display">\[
  \bar{Y} = \frac{1}{n} \sum_{t=1}^n(\mu + e_t + e_{t-1}) = 
    \mu + \frac{1}{n} \sum_{t=1}^n (e_t + e_{t-1}) = \mu + \frac{1}{n} \left( e_n + e_0 + 2 \sum_{t=1}^{n-1} t \right)
\]</span></p>
<p><span class="math display">\[
  \text{Var}[\bar{Y}] = \frac{1}{n^2}(\sigma_e^2 + \sigma_e^2 + 4(n-1) \sigma_e^2 ) = \frac{1}{n^2}2(2n-1)\sigma_e^2
\]</span></p>
<p>Setting <span class="math inline">\(Y_t = \mu + e_t\)</span> instead gives the result from 3.2. We note that for large <span class="math inline">\(n\)</span> the variance if approximately four times larger with <span class="math inline">\(Y_t = \mu + e_t + e_{t-1}\)</span>.</p>
</div>
<div id="hours" class="section level2">
<h2><span class="header-section-number">3.4</span> Hours</h2>
<div id="a-21" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(TSA)
<span class="kw">data</span>(<span class="st">&quot;hours&quot;</span>)
<span class="kw">xyplot</span>(hours)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-8-1.png" alt="Monthly values of the average hours worked per week in the U.S. manufacturing sector." width="672" />
<p class="caption">
Figure 3.1: Monthly values of the average hours worked per week in the U.S. manufacturing sector.
</p>
</div>
<p>In Figure 1 we see a steep incline between 83 and 84. There also appears to be a seasonal trend with generally longer work hours later in the year apart from the summer; 1984, however, does not exhibit as clear a pattern.</p>
</div>
<div id="b-21" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">months &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;J&quot;</span>)

<span class="kw">xyplot</span>(hours, <span class="dt">panel =</span> function(x, y, ...) {
  <span class="kw">panel.xyplot</span>(x, y, ...)
  <span class="kw">panel.text</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">labels =</span> months)
})</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-9"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-9-1.png" alt="Monthly values of average hours worked per week with superposed initials of months." width="672" />
<p class="caption">
Figure 3.2: Monthly values of average hours worked per week with superposed initials of months.
</p>
</div>
<p>Here, in Figure 2, our interpretation is largely the same. It is clear that December stands out as the month with the longest weekly work hours whilst February and January are low-points, demonstrating a clear trend.</p>
</div>
</div>
<div id="wages" class="section level2">
<h2><span class="header-section-number">3.5</span> Wages</h2>
<div id="a-22" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;wages&quot;</span>)
<span class="kw">xyplot</span>(wages, <span class="dt">panel =</span> function(x, y, ...) {
  <span class="kw">panel.xyplot</span>(x, y, ...)
  <span class="kw">panel.text</span>(x, y, <span class="dt">labels =</span> months)
})</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-10"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-10-1.png" alt="Monthly average hourly wages for workers in the U.S. apparel and textile industry." width="672" />
<p class="caption">
Figure 3.3: Monthly average hourly wages for workers in the U.S. apparel and textile industry.
</p>
</div>
<p>There is a positive trend with seasonality: August is a low-point for wages. Generally, there seems to be larger increases in the fall.</p>
</div>
<div id="b-22" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(wages ~<span class="st"> </span><span class="kw">time</span>(wages))
<span class="kw">summary</span>(wages_fit1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wages ~ time(wages))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.23828 -0.04981  0.01942  0.05845  0.13136 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -5.490e+02  1.115e+01  -49.24   &lt;2e-16 ***
## time(wages)  2.811e-01  5.618e-03   50.03   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08257 on 70 degrees of freedom
## Multiple R-squared:  0.9728, Adjusted R-squared:  0.9724 
## F-statistic:  2503 on 1 and 70 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_rst &lt;-<span class="st"> </span><span class="kw">rstudent</span>(wages_fit1)</code></pre></div>
</div>
<div id="c-11" class="section level3 unnumbered">
<h3>c</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(wages_rst ~<span class="st"> </span><span class="kw">time</span>(wages_rst), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>)</code></pre></div>
<div class="figure">
<img src="TSAsolutions_files/figure-html/wages_resid-1.png" alt="Residual plot" width="672" />
<p class="caption">
(#fig:wages_resid)Residual plot
</p>
</div>
<p>We still seem to have autocorrelation related to the time and not white noise.</p>
</div>
<div id="d-2" class="section level3 unnumbered">
<h3>d</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(wages ~<span class="st"> </span><span class="kw">time</span>(wages) +<span class="st"> </span><span class="kw">I</span>(<span class="kw">time</span>(wages)^<span class="dv">2</span>))
<span class="kw">summary</span>(wages_fit2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wages ~ time(wages) + I(time(wages)^2))
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.148318 -0.041440  0.001563  0.050089  0.139839 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -8.495e+04  1.019e+04  -8.336 4.87e-12 ***
## time(wages)       8.534e+01  1.027e+01   8.309 5.44e-12 ***
## I(time(wages)^2) -2.143e-02  2.588e-03  -8.282 6.10e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.05889 on 69 degrees of freedom
## Multiple R-squared:  0.9864, Adjusted R-squared:  0.986 
## F-statistic:  2494 on 2 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_rst2 &lt;-<span class="st"> </span><span class="kw">rstudent</span>(wages_fit2)</code></pre></div>
</div>
<div id="e-1" class="section level3 unnumbered">
<h3>e</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(wages_rst2 ~<span class="st"> </span><span class="kw">time</span>(wages_rst), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>)</code></pre></div>
<div class="figure">
<img src="TSAsolutions_files/figure-html/wages_quad_resid-1.png" alt="Residual plot for our quadratic model." width="672" />
<p class="caption">
(#fig:wages_quad_resid)Residual plot for our quadratic model.
</p>
</div>
<p>This looks more like random noise but there is still clear autocorrelation between the fitted residuals that we have yet to capture in our model.</p>
</div>
</div>
<div id="beer-sales" class="section level2">
<h2><span class="header-section-number">3.6</span> Beer sales</h2>
<div id="a-23" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(beersales)
<span class="kw">xyplot</span>(beersales)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-13-1.png" alt="Monthly U.S. beer sales." width="672" />
<p class="caption">
Figure 3.4: Monthly U.S. beer sales.
</p>
</div>
<p>Clear seasonal trends. There is an initial positive trend from 1975 to around 1981 that then levels out.</p>
</div>
<div id="b-23" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">months &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;D&quot;</span>)

<span class="kw">xyplot</span>(beersales,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.text</span>(x, y, <span class="dt">labels =</span> months)
       })</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-14"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-14-1.png" alt="Monthly U.S. beer sales annotated with the months' initials." width="672" />
<p class="caption">
Figure 3.5: Monthly U.S. beer sales annotated with the monthsâ€™ initials.
</p>
</div>
<p>It is now evident that the peaks are in the warm months and the slump in the winter and fall months. December is a particular low point, while May, June, and July seem to be the high points.</p>
</div>
<div id="c-12" class="section level3 unnumbered">
<h3>c</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beer_fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(beersales ~<span class="st"> </span><span class="kw">season</span>(beersales))
<span class="kw">summary</span>(beer_fit1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = beersales ~ season(beersales))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.5745 -0.4772  0.1759  0.7312  2.1023 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                12.48568    0.26392  47.309  &lt; 2e-16 ***
## season(beersales)February  -0.14259    0.37324  -0.382 0.702879    
## season(beersales)March      2.08219    0.37324   5.579 8.77e-08 ***
## season(beersales)April      2.39760    0.37324   6.424 1.15e-09 ***
## season(beersales)May        3.59896    0.37324   9.643  &lt; 2e-16 ***
## season(beersales)June       3.84976    0.37324  10.314  &lt; 2e-16 ***
## season(beersales)July       3.76866    0.37324  10.097  &lt; 2e-16 ***
## season(beersales)August     3.60877    0.37324   9.669  &lt; 2e-16 ***
## season(beersales)September  1.57282    0.37324   4.214 3.96e-05 ***
## season(beersales)October    1.25444    0.37324   3.361 0.000948 ***
## season(beersales)November  -0.04797    0.37324  -0.129 0.897881    
## season(beersales)December  -0.42309    0.37324  -1.134 0.258487    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.056 on 180 degrees of freedom
## Multiple R-squared:  0.7103, Adjusted R-squared:  0.6926 
## F-statistic: 40.12 on 11 and 180 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>All comparisons are made against january. The model helpfully explains approximately 0.71 of the variance and is statistically significant. Most of the factors are significant (mostly the winter months as expected).</p>
</div>
<div id="d-3" class="section level3 unnumbered">
<h3>d</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(beer_fit1) ~<span class="st"> </span><span class="kw">time</span>(beersales), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Time&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.text</span>(x, y, <span class="dt">labels =</span> <span class="kw">season</span>(beersales))
       })</code></pre></div>
<p><img src="TSAsolutions_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="e-2" class="section level3 unnumbered">
<h3>e</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fundamental-concepts.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/jolars/TSAsolutions/edit/master/03-trends.Rmd",
"text": "Edit"
},
"download": ["TSAsolutions.pdf", "TSAsolutions.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
